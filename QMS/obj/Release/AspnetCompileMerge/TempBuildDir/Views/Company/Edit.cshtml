@using NMS.Core.Resources
@model NMS.Data.Company

@{
    ViewBag.Title = CommonRes.Edit;
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>@CommonRes.Edit</h2>


@using (Html.BeginForm("Edit", "Company", FormMethod.Post,
                                                    new { enctype = "multipart/form-data" }))
{
    @Html.AntiForgeryToken()
    <form>


        <div class="row">

            <div class="col-lg-12">

                <div class="panel panel-light-blue">


                    <div class="panel-heading">

                        <h2 class="panel-title">@MenuRes.Company</h2>

                    </div>


                    <div class="panel-body">
                        <hr />



@Html.HiddenFor(m=>m.Comp_ID)
                        <div class="form-group row">


                            <div class="col-lg-3">
                                @Html.Label(NMSRes.Comp_Name)
                                @Html.TextBoxFor(m => m.Comp_Name, null, htmlAttributes: new { @class = "form-control" })

                                @Html.ValidationMessageFor(model => model.Comp_Name, "", new { @class = "text-danger" })

                                @*@id= "Name",*@
                            </div>


                            <div class="col-lg-3">
                                @Html.Label(NMSRes.Comp_Name_AR)
                                @Html.TextBoxFor(m => m.Comp_Name_AR, null, htmlAttributes: new { @class = "form-control" })

                                @Html.ValidationMessageFor(model => model.Comp_Name_AR)

                                @*@id= "Name",*@
                            </div>

                            <div class="col-lg-3">

                                @Html.Label(MenuRes.Comp_Type)
                                @Html.DropDownListFor(model => model.Comp_Type_ID, ViewBag.Comp_Type_ID as SelectList, new { @class = "form-control" })

                                @Html.ValidationMessageFor(model => model.Comp_Type_ID)
                                @*@id = "Name_AR",*@

                            </div>
                        </div>
                        @* ليبل *@

                        <div class="form-group row">


                            <div class="col-lg-3">
                                @Html.Label(NMSRes.Activity_Name)
                                @Html.DropDownListFor(model => model.Activity_ID, ViewBag.Activity_ID as SelectList, new { @class = "form-control" })
                                @Html.ValidationMessageFor(model => model.Activity_ID, "", new { @class = "text-danger" })

                            </div>


                            <div class="col-lg-3">

                                @Html.Label(NMSRes.City_ID)
                                @Html.DropDownListFor(model => model.City_ID, ViewBag.City_ID as SelectList, new { @class = "form-control" })

                                @Html.ValidationMessageFor(model => model.City_ID, "", new { @class = "text-danger" })
                                @*@id = "Name_AR",*@

                            </div>
                            <div class="col-lg-3">

                                @Html.Label(NMSRes.Country_ID)
                                @Html.DropDownListFor(model => model.Country_ID, ViewBag.Country_ID as SelectList, new { @class = "form-control" })

                                @Html.ValidationMessageFor(model => model.Country_ID, "", new { @class = "text-danger" })
                                @*@id = "Name_AR",*@

                            </div>

                        </div>
                        @* Section3 *@
                        <div class="form-group row">
                            <div class="col-lg-3">
                                @Html.Label(NMSRes.CommIssueDate)
                                @Html.TextBoxFor(m => m.IssueDate, null, htmlAttributes: new { @class = "form-control", @Date = "DatePicker" })

                                @Html.ValidationMessageFor(model => model.IssueDate, "", new { @class = "text-danger" })

                                @*@id= "Name",*@
                            </div>


                            <div class="col-lg-3">
                                @Html.Label(NMSRes.CommEndDate)
                                @Html.TextBoxFor(m => m.EndDate, null, htmlAttributes: new { @class = "form-control", @Date = "DatePicker" })

                                @Html.ValidationMessageFor(model => model.EndDate, "", new { @class = "text-danger" })

                                @*@id= "Name",*@
                            </div>



                            <div class="col-lg-3">

                                @Html.Label(NMSRes.Commercial_No)
                                @Html.TextBoxFor(m => m.Commercial_No, null, htmlAttributes: new { @class = "form-control" })

                                @Html.ValidationMessageFor(model => model.Commercial_No, "", new { @class = "text-danger" })
                                @*@id = "Name_AR",*@

                            </div>
                        </div>

                        @* Section4 *@
                        <div class="form-group row">
                            <div class="col-lg-3">

                                @Html.Label(NMSRes.Curr_ID)
                                @Html.DropDownListFor(model => model.Curr_ID, ViewBag.Curr_ID as SelectList, new { @class = "form-control" })

                                @Html.ValidationMessageFor(model => model.Curr_ID, "", new { @class = "text-danger" })
                                @*@id = "Name_AR",*@

                            </div>

                            <div class="form-group row">
                                <div class="col-lg-3">

                                    @Html.Label(NMSRes.Status)
                                    @Html.DropDownListFor(model => model.Status, ViewBag.Status as SelectList, new { @class = "form-control" })

                                    @Html.ValidationMessageFor(model => model.Status, "", new { @class = "text-danger" })
                                 

                                </div>

                                <div class="col-lg-3">
                                    @Html.Label(NMSRes.Logo)
                                    <input id="Logo" name="Logo" class="form-control" type="file" multiple accept=".png,.jpg,.jpeg,.gif" onchange="checkExt(this);">
                                    @Html.Label(Feedback.Feedback_Error, new { @id = "errMsgAr", @hidden = "hidden", @style = "color:red" })

                                    @Html.ValidationMessageFor(model => model.Logo)

                                   
                                </div>

                            </div>
                            </div>
                        @*<div>
                                <center>
                                    <p>
                                        <input type="button" value="@CommonRes.add" id="Add" class="btn btn-success hvr-bounce-in" onclick="add(this.id);"/>
                                    </p>
                                </center>


                            </div>*@



                        <div id="outputTable">

                        </div>

                        <div class="form-group">

                            <center class="mgtp">

                                <input type="submit" value="@CommonRes.Button_Save" class="btn btn-primary hvr-bounce-in" />
                                &nbsp;
                                @Html.ActionLink(CommonRes.BackToList, "Index", null, new { @class = "btn btn-warning hvr-bounce-in" })

                            </center>

                        </div>



                    </div>
                </div>

            </div>
        </div>

    </form>
}


<div>
    @Html.ActionLink(CommonRes.BackToList, "Index")
</div>

@section Scripts {
    <script type="text/javascript">
        $(function () {
            $('#Logo').fileupload({
                dataType: 'json',
                done: function (e, data) {
                    $.each(data.result.files, function (index, file) {
                        $('<p />').text(file.name).appendTo(document.body);
                    });
                }
            });
        });
        function add(_ddlDesc) {

            var target = $('#outputTable');
            var input = {
                Activity_ID: $('#Activity_ID').val(), City_ID: $('#City_ID').val()
                , Commercial_No: $('#Commercial_No').val(), Comp_Name: $('#Comp_Name').val()
           , Comp_Name_AR: $('#Comp_Name_AR').val(), Comp_Type_ID: $('#Comp_Type_ID').val()
           , Country_ID: $('#Country_ID').val(), Curr_ID: $('#Curr_ID').val()
           , IssueDate: $('#IssueDate').val(), EndDate: $('#EndDate').val()
           , Logo: $('#Logo').val()


            };

            $.ajax({
                url: '/Company/Add',
                type: "POST",
                data: JSON.stringify(input),
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                success: function (data) {
                    target.html(data);

                },
                error: function () {
                }
            });

            $('#Name_AR').val("");
            $('#Name').val("");

        }
        //Only Numbers/
        function isNumberKey(evt) {
            var charCode = (evt.which) ? evt.which : event.keyCode;
            if (charCode != 46 && charCode > 31
                && (charCode < 48 || charCode > 57))
                return false;

            return true;
        }

        //

        function checkExt(i) {

            var filename = i.value;
            //  var tst = $('#App_Doc[' + i.val + '].img').val();
            //  var filename = document.getElementById('#App_Doc[' + i + '].img').val();
            var extentionimg = filename.substr(filename.lastIndexOf('.') + 1);
            var valiidextentionimg = ['png', 'jpg', 'jpeg', 'gif'];
            if ($.inArray(extentionimg, valiidextentionimg) == -1) {
                $('#errMsgAr').show();
            }
            var myfilesize = i.files[0].size / 1024 / 1024;
            if (myfilesize > 5) {
                $('#errMsSize').show();
            }
        }
        //
    </script>
}
